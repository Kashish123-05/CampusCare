{% extends 'base.html' %}

{% block content %}
<h3 class="mb-4 fw-bold">Maintenance Dashboard</h3>

<div class="row mb-3">
    <div class="col-md-4">
        <div class="card h-100" onclick="window.openCampusAssistant&&openCampusAssistant()" style="cursor:pointer;background:linear-gradient(135deg,#fce7f3 0%,#f9a8d4 100%);border:none;transition:transform 0.2s" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
            <div class="card-body d-flex align-items-center">
                <div class="feature-icon ai me-2"><i class="bi bi-robot"></i></div>
                <div>
                    <h6 class="mb-0 fw-bold">AI Assistant</h6>
                    <small class="text-muted">Open chat</small>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card mb-3">
            <div class="card-header"><h5 class="mb-0 fw-bold"><i class="bi bi-list-task me-1"></i>My Assigned Issues</h5></div>
            <div class="card-body p-0">
                <table class="table table-hover mb-0">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Category</th>
                            <th>Priority</th>
                            <th>Status</th>
                            <th>Location</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for issue in assigned %}
                        <tr>
                            <td>{{ issue.title }}</td>
                            <td>{{ issue.get_category_display }}</td>
                            <td>{{ issue.get_priority_display }}</td>
                            <td><span class="badge status-{{ issue.status }}">{{ issue.get_status_display }}</span></td>
                            <td>{{ issue.location_building }} {{ issue.location_room }}</td>
                            <td><a href="{% url 'issues:issue_detail' issue.pk %}" class="btn btn-sm btn-primary">Update</a></td>
                        </tr>
                        {% empty %}
                        <tr><td colspan="6" class="text-center text-muted py-4">No assigned issues.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header"><h6 class="mb-0 fw-bold"><i class="bi bi-inbox me-1"></i>Unassigned Issues</h6></div>
            <ul class="list-group list-group-flush">
                {% for issue in unassigned %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ issue.title }} <small class="text-muted">({{ issue.get_priority_display }})</small></span>
                    <a href="{% url 'issues:issue_detail' issue.pk %}" class="btn btn-sm btn-outline-primary">View</a>
                </li>
                {% empty %}
                <li class="list-group-item text-muted">No unassigned issues.</li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
{% endblock %}
